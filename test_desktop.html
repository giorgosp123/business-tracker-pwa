<!DOCTYPE html>
<html lang="el">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Desktop Compatibility Test</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background: #f5f5f5;
        }
        
        .test-section {
            background: white;
            padding: 20px;
            margin: 20px 0;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        
        .success { color: green; }
        .error { color: red; }
        .warning { color: orange; }
        
        button {
            background: #667eea;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            margin: 5px;
        }
        
        #results {
            margin-top: 20px;
            padding: 10px;
            background: #f0f0f0;
            border-radius: 5px;
        }
    </style>
</head>
<body>
    <h1>üñ•Ô∏è Desktop Compatibility Test</h1>
    
    <div class="test-section">
        <h2>Browser Information</h2>
        <div id="browser-info">
            <p><strong>User Agent:</strong> <span id="user-agent"></span></p>
            <p><strong>Screen Resolution:</strong> <span id="screen-resolution"></span></p>
            <p><strong>Window Size:</strong> <span id="window-size"></span></p>
            <p><strong>Device Type:</strong> <span id="device-type"></span></p>
        </div>
    </div>
    
    <div class="test-section">
        <h2>Dashboard Loading Test</h2>
        <p>Test if the dashboard loads correctly on this device:</p>
        <button onclick="testDashboard()">üîÑ Test Dashboard Loading</button>
        <button onclick="clearLocalStorage()">üóëÔ∏è Clear Local Storage</button>
        <button onclick="openDashboard()">üìä Open Dashboard</button>
        <div id="results"></div>
    </div>
    
    <div class="test-section">
        <h2>LocalStorage Test</h2>
        <p>Test data persistence:</p>
        <button onclick="testLocalStorage()">üíæ Test Storage</button>
        <div id="storage-results"></div>
    </div>
    
    <div class="test-section">
        <h2>Quick Fixes</h2>
        <p>If dashboard doesn't work:</p>
        <button onclick="applyDesktopFixes()">üõ†Ô∏è Apply Desktop Fixes</button>
        <button onclick="resetCache()">üîÑ Reset Cache</button>
        <div id="fixes-results"></div>
    </div>

    <script>
        // Display browser information
        document.getElementById('user-agent').textContent = navigator.userAgent;
        document.getElementById('screen-resolution').textContent = `${screen.width}x${screen.height}`;
        document.getElementById('window-size').textContent = `${window.innerWidth}x${window.innerHeight}`;
        
        // Detect device type
        const isMobile = /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);
        const isTablet = /iPad/i.test(navigator.userAgent) || (navigator.platform === 'MacIntel' && navigator.maxTouchPoints > 1);
        const isDesktop = !isMobile && !isTablet;
        
        let deviceType = 'Unknown';
        if (isDesktop) deviceType = 'üñ•Ô∏è Desktop';
        else if (isTablet) deviceType = 'üì± Tablet';
        else if (isMobile) deviceType = 'üì± Mobile';
        
        document.getElementById('device-type').textContent = deviceType;
        
        function testDashboard() {
            const results = document.getElementById('results');
            results.innerHTML = '<p>üîÑ Testing dashboard loading...</p>';
            
            // Create a test iframe to load the dashboard
            const iframe = document.createElement('iframe');
            iframe.style.display = 'none';
            iframe.src = './dashboard.html';
            
            iframe.onload = function() {
                results.innerHTML = '<p class="success">‚úÖ Dashboard loads successfully!</p>';
                setTimeout(() => {
                    document.body.removeChild(iframe);
                }, 1000);
            };
            
            iframe.onerror = function() {
                results.innerHTML = '<p class="error">‚ùå Dashboard failed to load!</p>';
                document.body.removeChild(iframe);
            };
            
            document.body.appendChild(iframe);
        }
        
        function clearLocalStorage() {
            localStorage.clear();
            sessionStorage.clear();
            document.getElementById('results').innerHTML = '<p class="success">‚úÖ Storage cleared!</p>';
        }
        
        function openDashboard() {
            window.open('./dashboard.html', '_blank');
        }
        
        function testLocalStorage() {
            const results = document.getElementById('storage-results');
            try {
                const testKey = 'desktop_test_' + Date.now();
                const testValue = 'Desktop compatibility test data';
                
                localStorage.setItem(testKey, testValue);
                const retrieved = localStorage.getItem(testKey);
                localStorage.removeItem(testKey);
                
                if (retrieved === testValue) {
                    results.innerHTML = '<p class="success">‚úÖ LocalStorage working correctly!</p>';
                } else {
                    results.innerHTML = '<p class="error">‚ùå LocalStorage read/write failed!</p>';
                }
            } catch (e) {
                results.innerHTML = `<p class="error">‚ùå LocalStorage error: ${e.message}</p>`;
            }
        }
        
        function applyDesktopFixes() {
            const results = document.getElementById('fixes-results');
            
            // Clear any mobile-specific settings
            localStorage.removeItem('mobile-optimized');
            localStorage.removeItem('touch-enabled');
            
            // Set desktop preferences
            localStorage.setItem('desktop-optimized', 'true');
            localStorage.setItem('viewport-fixed', 'true');
            
            results.innerHTML = '<p class="success">‚úÖ Desktop optimizations applied! Try opening the dashboard now.</p>';
        }
        
        function resetCache() {
            const results = document.getElementById('fixes-results');
            
            // Clear all app-related storage
            const keys = Object.keys(localStorage);
            keys.forEach(key => {
                if (key.includes('business') || key.includes('sales') || key.includes('dashboard')) {
                    localStorage.removeItem(key);
                }
            });
            
            // Force reload with cache bypass
            if ('serviceWorker' in navigator) {
                navigator.serviceWorker.getRegistrations().then(function(registrations) {
                    for(let registration of registrations) {
                        registration.unregister();
                    }
                });
            }
            
            results.innerHTML = '<p class="success">‚úÖ Cache reset complete! Dashboard should work better now.</p>';
        }
        
        // Auto-run basic tests on load
        setTimeout(() => {
            testLocalStorage();
            
            // Show device-specific recommendations
            const recommendations = document.createElement('div');
            recommendations.className = 'test-section';
            
            if (isDesktop) {
                recommendations.innerHTML = `
                    <h2>üñ•Ô∏è Desktop Recommendations</h2>
                    <p class="success">Great! You're on desktop. The dashboard should work perfectly.</p>
                    <p><strong>Recommended browser:</strong> Chrome, Firefox, or Edge (latest versions)</p>
                    <p><strong>Screen resolution:</strong> Your ${screen.width}x${screen.height} resolution is excellent for the dashboard</p>
                `;
            } else if (isMobile) {
                recommendations.innerHTML = `
                    <h2>üì± Mobile Device Detected</h2>
                    <p class="warning">You're on a mobile device, but the dashboard now supports both mobile and desktop!</p>
                    <p><strong>Tip:</strong> Rotate to landscape mode for better experience</p>
                `;
            }
            
            document.body.appendChild(recommendations);
        }, 500);
        
        console.log('üñ•Ô∏è Desktop compatibility test page loaded');
        console.log('Device type:', deviceType);
        console.log('Screen size:', screen.width + 'x' + screen.height);
        console.log('Window size:', window.innerWidth + 'x' + window.innerHeight);
    </script>
</body>
</html>
